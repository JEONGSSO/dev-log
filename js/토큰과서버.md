# 토큰 기반 인증 과 서버 기반 인증



## 1.서버기반 인증 시스템

서버측에서 사용자들의 정보를 기억하고 있는 방법.
정보를 기억하기 위해 세션을 유지하는데, 메모리나 디스크, DB등을 통해 관리한다.
서버 기반의 인증 시스템은 클라이언트로부터 요청을 받으면 클라이언트의 상태를 유지해야하고 이 정보를 서비스에 이용하는데, sateful서버라고 한다.

1. 세션
   - 사용자가 인증을 할 때, 서버는 사용자의 정보를 저장해야 하고 이를 세션(Session). 대부분은 메모리나 DB에 저장을하는데 , 사용자가 늘어날 경우 무리가 될 수 있다. 
2. 확장성
   - 사용자가 늘어나게 되면, 프로세스를 여러개 돌리거나, 컴퓨터를 추가하는 등 서버 확장이 필요. 세션을 분산시키는 시스템은 비용이 크다.
3. CORS
   - 웹에서 세션을 관리할 때 자주 사용되는 쿠키는 단일 도메인이나 서브 도메인에서만 작동. 쿠키를 여러 도메인에서 관리하는 것은 번거로움이 크다.

이러한 문제들로 토큰방식의 인증 시스템을 사용하게 되었다.

---
## 2.토큰 기반 인증 시스템

인증받은 사용자들에게 토큰을 발급하고, 서버에 요청을 할 때 헤더에 토큰을 함께 보내도록 해 유효성 검사를 실행.
사용자의 인증 정보를 서버나 세션에 유지하지 않고, 클라이언트에서 들어오는 요청만으로 처리.
서버기반과는 달리 상태를 유지하지 않으므로, Stateless한 구조를 가진다.

동작 방식 
1. 사용자가 로그인 한다.
2. 서버측에서 해당 정보를 검증
3. 정보가 유효하다면 서버 측에서 사용자에게 Signed 토큰을 발급.
4. 클라이언트 측에선 발급된 토큰을 저장해두고 서버에 요청을 할 때 마다 해당 토큰을 같이 전달(http 헤더에 토큰을 포함)
5. 서버는 토큰을 검증 후 응답.

토큰기반 인증 시스템의 이점

1. 무상태성과 확장성
   - 토큰은 클라이언트에 저장되어서 클라이언트와 서버의 연결이 항시 유지되어있는 것은 아니므로 확장하기에 매우 적합, 만약 서버측 세션에 저장된 경우에 서버를 확장하고 분산처리한다면 해당 사용자는 기존에 정보가 있던 서버에 요청을 받도록 해야함. 
2. 보안성
   -클라이언트가 서버로 요청을 보낼 때 쿠키를 전달하지 않으므로, 쿠키 보안 취약점이 사라지게 된다. 다만 토큰 보안 취약점에 노출될 수 있다.
3. 확장성
   -토큰에 선택적인 권한만 부여할 수 있으며 OAuth는 FB, Google등 소셜계정으로 다른 웹서비스에 로그인이 가능하다.
4. 여러 플랫폼 및 도메인
   -서버 기반인증 문제점인 cors문제를 해결, 토큰을 사용한다면 어떤 디바이스, 도메인에서도 토큰의 유효성 검사만 확인하면 된다. 이 때문에 assests 파일은 cdn에서 제공하고 서버에서는 api만 다루도록 처리할 수 있다.

